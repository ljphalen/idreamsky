webpackJsonp([24],{Bp2U:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={created:function(){this.getEnumList(),this.account_id&&this.getAdCampaigns()},watch:{account_id:function(){this.getAdCampaigns()}},computed:{account_id:function(){return this.$store.getters.get_account_action.account_id}},data:function(){return{loading:!1,conversionShow:!1,name_size:0,description_size:0,form:{type:"AD",campaign_id_list:[],rule_type:"",conversion_type:[],time_window:30,name:"",description:""},rule_type_list:{},conversion_type_list:{},campaignList:[]}},methods:{onCancel:function(){this.$router.push("/setting/audience")},audienceNameChange:function(t){this.name_size=this.form.name.length},onSubmit:function(){if(0==this.form.campaign_id_list.length)return this.$message.error("请选择推广计划"),!1;if(""==this.form.rule_type)return this.$message.error("请选择广告行为"),!1;if("CONVERSION"==this.form.rule_type&&0==this.form.conversion_type.length)return this.$message.error("请选择转化类型"),!1;if(this.form.time_window>60)return this.$message.error("时间范围最大值为60"),!1;if(""==this.form.name)return this.$message.error("人群名称不能为空"),!1;var t=this.form,e=this;e.loading=!0,t.account_id=this.account_id,this.$axios.get("/Admin/Marketing_CustomAudiences/add",{params:t}).then(function(t){e.loading=!1;var i=t.data;0==i.code?(e.$message({type:"success",message:i.msg}),setTimeout(function(){e.$router.push("/setting/audience")},500)):e.$message.error(i.msg)}).catch(function(t){e.$message("网络繁忙，请稍后再试！"),console.log(t)})},getEnumList:function(){var t=this;this.$axios.get("/Admin/Marketing_Common/getEnum",{}).then(function(e){var i=e.data;0==i.code&&(t.rule_type_list=i.data.RULE_TYPE,t.conversion_type_list=i.data.CONVERSION_TYPE)}).catch(function(t){console.log(t)})},getAdCampaigns:function(){var t={page:1,page_size:100},e=this;t.account_id=this.account_id,this.$axios.get("/Admin/Marketing_Campaigns/get",{params:t}).then(function(t){var i=t.data;0==i.code?(i.data.list||i.data.page_info)&&e.formatCampaignList(i.data.list):e.$message(i.msg)}).catch(function(t){e.$message("网络繁忙，请稍后再试！"),e.loadingCampaign=!1})},formatCampaignList:function(t){var e=this;this.campaignList=[],t.forEach(function(t,i){e.campaignList.push({label:t.campaign_name,key:t.campaign_id})})},filterMethod:function(t,e){return e.label.indexOf(t)>-1},ruleTypeChange:function(t){this.conversionShow="CONVERSION"==t}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"template-container"},[i("div",{staticClass:"template-container-title"},[t._v("创建人群-广告受众")]),t._v(" "),i("el-form",{ref:"form",attrs:{model:t.form}},[i("div",{staticClass:"temp-item-block"},[i("div",{staticClass:"temp-item-title"},[t._v("1.选择广告推广计划")]),t._v(" "),i("div",{staticClass:"temp-item-main"},[i("el-transfer",{attrs:{filterable:"","filter-method":t.filterMethod,"filter-placeholder":"推广计划名称",data:t.campaignList,titles:["未选","已选"],panelWidth:"500px;"},model:{value:t.form.campaign_id_list,callback:function(e){t.$set(t.form,"campaign_id_list",e)},expression:"form.campaign_id_list"}})],1)]),t._v(" "),i("div",{staticClass:"temp-item-block"},[i("div",{staticClass:"temp-item-title"},[t._v("2.选择广告行为")]),t._v(" "),i("div",{staticClass:"temp-item-main"},[i("div",[i("el-radio-group",{staticClass:"temp-radio-group",on:{change:t.ruleTypeChange},model:{value:t.form.rule_type,callback:function(e){t.$set(t.form,"rule_type",e)},expression:"form.rule_type"}},t._l(t.rule_type_list,function(e,a){return i("span",{key:a,staticClass:"temp-radio-item",staticStyle:{"padding-right":"20px"}},[i("el-radio-button",{attrs:{label:a}},[t._v(t._s(e))])],1)})),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.conversionShow,expression:"conversionShow"}],staticClass:"conversion-box"},[i("el-checkbox-group",{model:{value:t.form.conversion_type,callback:function(e){t.$set(t.form,"conversion_type",e)},expression:"form.conversion_type"}},t._l(t.conversion_type_list,function(e,a){return i("el-checkbox",{key:a,staticClass:"conversion-checkbox",attrs:{label:a}},[t._v(t._s(e))])}))],1)],1)])]),t._v(" "),i("div",{staticClass:"temp-item-block"},[i("div",{staticClass:"temp-item-title"},[t._v("3.选择时间范围")]),t._v(" "),i("div",{staticClass:"temp-item-main"},[i("div",{staticClass:"temp-item-block"},[i("div",{staticClass:"temp-item-inlineblock"},[t._v("\n              最近\n            "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.time_window,expression:"form.time_window"}],staticClass:"temp-long-inputtext",staticStyle:{"margin-left":"8px",width:"20px",border:"1px solid #e3e4e5"},attrs:{type:"text"},domProps:{value:t.form.time_window},on:{input:function(e){e.target.composing||t.$set(t.form,"time_window",e.target.value)}}}),t._v("\n            天内\n              "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("数据将实时更新，计算距离当天往前最近"+t._s(t.form.time_window)+"天内")]),t._v(" "),i("p",[t._v("的数据")])]),t._v(" "),i("el-button",{attrs:{type:"text"}},[i("i",{staticClass:"el-icon-question"})])],1)],1)]),t._v(" "),i("div",{staticClass:"temp-item-block"},[i("label",{staticClass:"temp-item-label",attrs:{for:""}},[t._v("人群名称：")]),t._v(" "),i("div",{staticClass:"temp-item-inlineblock"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"temp-long-inputtext",attrs:{type:"text",maxlength:"32"},domProps:{value:t.form.name},on:{input:[function(e){e.target.composing||t.$set(t.form,"name",e.target.value)},t.audienceNameChange]}}),t._v(" "),i("span",{staticClass:"temp-item-inlayremark"},[t._v(t._s(t.name_size)+"/32")])])]),t._v(" "),i("div",{staticClass:"temp-item-block"},[i("label",{staticClass:"temp-item-label",attrs:{for:""}},[t._v("人群描述：")]),t._v(" "),i("div",{staticClass:"temp-item-inlineblock"},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"（选填）"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)])])]),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("完成")]),t._v(" "),i("el-button",{on:{click:t.onCancel}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var n=i("VU/8")(a,s,!1,function(t){i("hAn8")},null,null);e.default=n.exports},hAn8:function(t,e){}});
//# sourceMappingURL=24.a20cb41572f967246e8e.js.map