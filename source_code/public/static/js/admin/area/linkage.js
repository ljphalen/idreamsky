/*!
 *@mode \u4e09\u7ea7\u7ea7\u8054
 *@Author wangwenlong@ttop.com
 *@Date 2012.02.20
 */
(function(f){function d(j,i,h){if(!i||!j){return j}if(h===undefined){h=true}for(var k in i){if(h||!(k in j)){j[k]=i[k]}}return j}function a(h){return Object.prototype.toString.call(h).slice(8,-1)==="String"}var e=function(n,i){var k={node1:null,node2:null,node3:null};if(!i&&i!=0){return k}for(var l in n){for(var h in n[l].items){for(var j in n[l].items[h].items){k.node3=n[l].items[h].items[j];if(k.node3==i){k.node1=n[l].val;k.node2=n[l].items[h].val;return k}else{k.node3=null}}}}return k},b=function(l,i,h,j){var m=f("<option>").text(i).val(i+"|"+h).attr("title",h);if(h==j){m.attr("selected","selected")}m.appendTo(l)},g=function(j){var k=a(j.s1)?f(j.s1):j.s1,i=a(j.s2)?f(j.s2):j.s2,h=a(j.s3)?f(j.s3):j.s3,n=j.v1||null,m=j.v2||null,l=j.v3||null;f.each(j.d,function(p,o){b(k,p,o.val,n)});k.change(function(){i.html("");h.html("");if(this.selectedIndex==-1){return}var o=this.options[this.selectedIndex].value;f.each(j.d,function(q,p){if(o.replace(/^.*\|/g,"")==p.val){if(p.items){f.each(p.items,function(s,r){b(i,s,r.val,m)})}}});if(i[0].options.length==0){b(i,"...","",m)}});i.change(function(){h.html("");var o=k[0].options[k[0].selectedIndex].value;if(this.selectedIndex==-1){return}var p=this.options[this.selectedIndex].value;f.each(j.d,function(r,q){if(o.replace(/^.*\|/g,"")==q.val){if(q.items){f.each(q.items,function(t,s){if(p.replace(/^.*\|/g,"")==s.val){f.each(s.items,function(w,u){b(h,w,u,l)})}});if(h[0].options.length==0){b(h," ","",l);h.hide()}}}})});if(n){k.trigger("change");i.trigger("change")}};var c={init:function(h){if(h.isArea){if(!h.areaWrap.length){return}c.areaLinkage(CitySelectData,h)}if(h.isIndustry){if(!h.industryWrap.length){return}c.industryLinkage(IndustrySelectData,h)}},areaLinkage:function(l,h){var k=e(l,h.aNode),j={d:l,v1:k.node1,v2:k.node2,v3:k.node3},i=d(h,j);g(i)},industryLinkage:function(l,h){var j=e(l,h.iNode),k={d:l,v1:j.node1,v2:j.node2,v3:j.node3},i=d(h,k);g(i)}};f.linkage=c.init})(jQuery);
